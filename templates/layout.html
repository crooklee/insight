<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="/static/image/favicon.ico">

    <title>交通视频感知平台</title>

    <!-- Bootstrap core CSS -->
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/bootstrap-theme.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/static/css/jquery.datetimepicker.css"/>

    <!-- Custom styles for this template -->
    <link href="/static/css/dashboard.css" rel="stylesheet">
    <link href="/static/css/jquery-ui.css" rel="stylesheet">
    

    <style type="text/css">
        label {max-width:none;}
    </style>

    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=F4VeNCCZnyk1zEkrXk3t2z27"></script>
    <!--
    <script type="text/javascript" src="http://api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js"></script>
     -->
   
</head>
<body>    
    
       <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container-fluid">        
        <div class="navbar-header">          
          <a class="navbar-brand" href="#">交通视频感知平台</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">  
           
            <li><a href="/auth/profile">{{ user.name }}</a></li>          
            <li><a href="/auth/logout">退出</a></li>
           			
          </ul>         
        </div>       
      </div>
    </nav>
    
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-3 col-md-2 sidebar">
                <ul class="nav nav-sidebar">
                    {%block nav_sidebar%}       
                    <li id="events"><a href="/">异常事件告警 <span class="badge" id="num_event"></span></a></li>             
                    <li id="visualization"><a href="/visualization">异常事件定位</a></li> 
                    <li id="statistics"><a href="/statistics">异常事件统计</a></li>  
                    <br>
                    <li id="departments"><a href="/departments">职能委办配置</a></li>     
                    <li id="locations"><a href="/locations">监控点位配置</a></li> 
                     {%end%}
                </ul>        
            </div>       
            
                                 
            <section id="content">
                {% block content %}
                {% end %}
            </section>       
        </div>
    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/jquery.datetimepicker.js"></script>
    <script src="/static/js/jquery-ui.js"></script>
    <script src="/static/js/chart.js"></script>
    
{%block active%}
{%end%}

</body>

{% block map %}
{% end %}

{%block script%}
{%end%}

<script type="text/javascript">    
var ws_global = new WebSocket('ws://127.0.0.1:8888/ws_global');
ws_global.onopen = function(){
    console.log("ws_global open")
};
ws_global.onmessage = function(ev){
    var json = JSON.parse(ev.data);
    console.log(json)
    $('#num_event').html(json.num_event);
};
ws_global.onclose = function(ev){
  console.log("ws_global close")
};
ws_global.onerror = function(ev){
  console.log("ws_global error")
};
</script>
</html>
